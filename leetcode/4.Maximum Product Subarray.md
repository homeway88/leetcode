#Day4：Maximum Product Subarray【难度3】

题目：给定一个整数的数组，找出一个连续的子数组，使其乘积最大，返回最大的乘积值。

>Find the contiguous subarray within an array (containing at least one number) which has the largest product.
>
>For example, given the array `[2,3,-2,4]`,
>
>the contiguous subarray `[2,3]` has the largest product = 6.
>
>[https://oj.leetcode.com/problems/maximum-product-subarray/](https://oj.leetcode.com/problems/maximum-product-subarray/ "https://oj.leetcode.com/problems/maximum-product-subarray/")
>
>[http://www.coderblog.cn/article/61/](http://www.coderblog.cn/article/61/ "http://www.coderblog.cn/article/61/")

由于给定的是整数数组，因此出现的只可能是正数，0，负数。 0 是连续子数组最明显的分界线，因为任何数跟0的乘积都是0，因此可由0将数组分成几个子数组，并把问题分成几个小问题。

如数组`[1,2,3,0,4,5,6]`,其中0将数组分为`[1,2,3]`与`[4,5,6]`，我们只需要分别求两个数组的最大连续乘积，取其较大者即可。

另外需要特别考虑的就是正数与负数的问题：

对连续的正数，因为其值大于或等于1，乘积必须是递增的（至少不会减少）；

那么对于负数，就比较麻烦了，因为出现奇数个负数，会使乘积变成负的，如果出现偶数个负数，则非常简单，乘积依然会保持正号，因此，需要特别处理的，就是出现奇数个负数的情况，下面对出现奇数个负数的情况进行推理：

* 一个负数的情况，如`[1,2,3,-1,2,3,4]`,很显然，由负数将数组分开，变成`[1,2,3]`与`[2,3,4]`
* 三个负数的情况，如`[1,1,-1,2,2,-2,3,3,-3]`，我们必须舍弃一个负数，才能保持数组的正号，可以证明，只能舍弃第一个负数，或者最后一个负数，才能使连续乘积最大。因为如果舍弃`-2`，那么数组将变成`[1,1,-1,2,2]`与`[3,3,-3]`，很明显乘积都是负数；
* 五个负数的情况，如`[1,-1,2,-2,3,-3,4,-4,5,-5,6]`，依然可以证明，只能舍弃第一个负数，或者最后一个负数，才能使连续乘积最大。因为，假设舍弃第三个负数`-3`后,`[4,-4,5,-5,6]`最大，但是，我们只要再加上第二个负数到第三个负数之间的数组得到`[2,-2,3,-3,4,-4,5,-5,6]`，就可以使得整个乘积更大。结论得证。因此，最大乘积必是`[1,-1,2,-2,3,-3,4,-4,5]`(舍弃最后一个负数)与`[2,-2,3,-3,4,-4,5,-5,6]`（舍弃第一个负数）中乘积较大者。



因此，算法的步骤是：

* 由左往右扫描数组，记录开始的位置，负数的个数，且记录第一个负数与最后一个负数的位置；
* 如果遇到0（记结束位置为0之前那个位置）或者数组结束（结束位置为数组尾），此时如果负数的个数为偶数个，直接计算由开始位置到结束位置的乘积，并与最大的乘积值作比较，取其较大值；如果此时负数的个数为奇数，将数组分为`[开始位置：最后一个负数前一个位置]`和`[第一个负数后一个位置：结束位置]`，取其乘积较大值。